<div class="panel panel-primary">
	<div class="panel-heading">
		今月の走行距離は<strong><%= @practice_diaries_all.this_month_distance %>km</strong>です！
	</div>
	<div class="row">
		<div class="panel-body">
			<div class="col-md-4">
				<% if current_user.image? %>
					<image src=<%= current_user.image %> class = "icon_image">
				<% else %>
					<image src="/assets/default_icon.png" class = "icon_image">
				<% end %>
			</div>

			<div class="col-md-8">
				<ul class="list-group">
					<li class="list-group-item">
						<strong><%= User.human_attribute_name(:user_name) %>：<%= link_to current_user.user_name, user_path(current_user) %></strong>
					</li>
					<li class="list-group-item">
						<strong><%= User.human_attribute_name(:self_introduction) %>：
						<% if current_user.self_introduction == "" %>
							<%= "まだ自己紹介はありません。" %>
						<% else %>
							<%= simple_format current_user.self_introduction %>
						<% end %>
						</strong>
					</li>
					<li class="list-group-item">
						<strong><%= User.human_attribute_name(:target) %>：
						<% if current_user.target == "" %>
							<%= "まだ目標はありません。" %>
						<% else %>
							<%= simple_format current_user.target %>
						<% end %>
						</strong>
					</li>
					<li class="list-group-item">
						<strong>
							<%= link_to followers_user_path(current_user) do %>
								フォロー：<%= current_user.followers.count %>人
							<% end %>
							<%= link_to following_user_path(current_user) do %>
								フォロワー：<%= current_user.following.count %>人
							<% end %>
						</strong>
					</li>
				</ul>
			</div>
		</div>
	</div>
</div>

<h2>マイカレンダー</h2>
<%= month_calendar(attribute: :practice_date, events: @practice_diaries_all)  do |date, practice_diaries| %>
  <%= date %>

  	<% practice_diaries.each do |practice_diary| %>
			<div>
				<span class="glyphicon glyphicon-fire fire-icon"></span>
				<%= link_to practice_diary.practice_title, practice_diary %>
				<%= practice_diary.practice_distance %> km
			</div>
  	<% end %>
<% end %>

<h2>練習記録一覧</h2>

<div class="row">
	<div class="search-form col-md-6 col-sm-8 col-xs-12">
		<h3>検索<small> ※複数条件や部分一致での検索も可能です。</small></h3>
		<%= form_with(scope: :search, url: practice_diaries_path, method: :get, local: true) do |f| %>
			<div class="form-group">
				<%= f.label(:practice_title, PracticeDiary.human_attribute_name(:practice_title)) %>
				<%= f.text_field :practice_title, value: @search_params[:practice_title], class: "form-control", placeholder: "タイトルを入力してください" %>
			</div>

			<div class="form-group">
				<%= f.label(:practice_content, PracticeDiary.human_attribute_name(:practice_content)) %>
				<%= f.text_field :practice_content, value: @search_params[:practice_content], class: "form-control", placeholder: "詳細を入力してください" %>
			</div>

			<div class="form-inline">
				<div class="form-group">
					<%= f.label(:practice_date, PracticeDiary.human_attribute_name(:practice_date)) %><br>
					<%= f.date_field :practice_date_from, value: @search_params[:practice_date_from], class: "form-control" %> ~ <%= f.date_field :practice_date_to, value: @search_params[:practice_date_to], class: "form-control" %>
				</div>
			</div>
			<div class="form-group">
				<br><%= f.submit '検索', class: "btn btn-info" %><%= link_to 'クリア', practice_diaries_path, class: "btn btn-danger"%>
			</div>
		<% end %>
	</div>
</div>

<%= paginate @practice_diaries %>

<% if @practice_diaries.present? %>
	<p>
	<%= @practice_diaries.total_count %>件中<%= @practice_diaries.offset_value + 1 %>
	〜<%= @practice_diaries.offset_value + @practice_diaries.length %>件を表示しています。
	</p>
<% else %>
	<h3>まだ練習記録が投稿されていません。</h3>
<% end %>

<div class="row">
	<% @practice_diaries.each do |practice_diary| %>
		<div class="col-md-6 col-sm-6 col-xs-12">
			<div class="panel panel-primary">
				<div class="panel-heading">
					<%= practice_diary.set_practice_date %>
				</div>
				<div class="panel-body">
					<p><%= PracticeDiary.human_attribute_name(:practice_title) %>：<%= practice_diary.practice_title %></p>
					<p><%= PracticeDiary.human_attribute_name(:practice_content) %>：<%= practice_diary.practice_content.truncate(30) %></p>
					<p><%= PracticeDiary.human_attribute_name(:practice_distance) %>：<%= practice_diary.practice_distance %>km</p>
					<p><%= link_to '詳細を見る', practice_diary_path(practice_diary) %></p>
					<h3 id="practice_favorites_buttons_<%= practice_diary.id %>" class="text-right">
					<%= render partial: 'practice_favorites/practice_favorite', locals: { practice_diary: practice_diary} %><span class="glyphicon glyphicon-comment comment-icon" aria-hidden="true"></span><span class="badge"><%= practice_diary.practice_comments.count %></span>
					</h3>
				</div>
				<div class="panel-footer">
					<div class="text-right">
						<p>投稿日時：<%= localize(practice_diary.updated_at, 'Asia/Tokyo') %></p>
					</div>
				</div>
			</div>
		</div>
	<% end %>
</div>